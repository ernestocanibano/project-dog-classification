(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"./src/util/tracing.ts":function(e,n,t){"use strict";t.r(n),t.d(n,"init",(function(){return c})),t.d(n,"extractSpan",(function(){return u})),t.d(n,"instrumentAppPerformance",(function(){return l}));var r=t("./node_modules/lightstep-tracer/browser.js"),o=t("./node_modules/opentracing/lib/index.js"),s=t("./src/store/actions/debug.ts"),i=t("./src/store/selectors/session.ts"),a=t("./src/util/performance.ts"),c=function(e){var n=e.name,t=e.host,s=e.token,i=e.appVersion,a=new r.Tracer({component_name:n,xhr_instrumentation:!1,access_token:s,collector_host:t,default_span_tags:{"component.version":i}});return Object(o.initGlobalTracer)(a),a},u=function(e,n){return n?e.extract(o.FORMAT_HTTP_HEADERS,n):null},l=function(e){var n=e.tracer,t=e.originalSpan,r=e.dispatch,c=e.reporter,u=e.userId,l=e.route,f=e.additionalSpanTags,d=(f=void 0===f?{}:f).performanceTags,p=void 0===d?[]:d,g=f.glyphEmbed,m=l?l.metricName:"unidentified",b={"user.logged_in":Object(i.a)(u),"req.route_name":m,"req.route":m,"req.glyph_embed":g};p.forEach((function(e){return b["req.".concat(e)]=1}));var v={loggedIn:Object(i.a)(u),route:m,withinPostInternalLinksExperiment:p.includes("post_internal_links")},h=function(e){return Math.round(1e3*e)},_=function(e,t,r,o){var s=r.start,i=r.end,a=n.startSpan("timing.".concat(t),{childOf:e,tags:b}).setBeginMicros(h(s)).setEndMicros(h(i));return null!=o&&o(a),a.finish(),a};a.f.observe((function(e){c.reportRender(v,e);var i=n.startSpan("timing.navigation",{references:[Object(o.followsFrom)(t)],tags:b}).setBeginMicros(h(e.load.start)).setEndMicros(h(e.load.end));_(i,"beforeDomainLookup",e.beforeDomainLookup),_(i,"domainLookup",e.domainLookup),_(i,"connect",e.connect),_(i,"request",e.request),_(i,"response",e.response),_(i,"processing",e.processing);var a=e.overallFCP,u=e.client,l=e.render;null!=a&&_(i,"firstContentfulPaint",a),null!=u&&_(i,"client",u,(function(e){null!=l&&_(e,"render",l)})),i.finish(),r(Object(s.c)(i.generateTraceURL()))})),a.b.observe((function(e){c.reportFirstContentfulPaint(v,e),n.startSpan("timing.firstContentfulPaint.v2",{references:[Object(o.followsFrom)(t)],tags:b}).setBeginMicros(h(e.start)).setEndMicros(h(e.end)).finish()})),a.d.observe((function(e){c.reportLargestContentfulPaint(v,e),n.startSpan("timing.largestContentfulPaint",{references:[Object(o.followsFrom)(t)],tags:b}).setBeginMicros(h(e.start)).setEndMicros(h(e.end)).finish()})),a.g.observe((function(e){e&&c.reportUnsupportedPerfObserver(v)})),a.c.observe((function(e){c.reportInput(v,e),n.startSpan("timing.input.first.delay",{references:[Object(o.followsFrom)(t)],tags:b}).setBeginMicros(h(e.start)).setEndMicros(h(e.end)).finish()}))}}}]);
//# sourceMappingURL=tracing.093942a4.chunk.js.map